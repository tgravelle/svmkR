<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fetch survey results from the SurveyMonkey API and turn them into tidy data.frames in an optimized way. ‚Ä¢ svmkR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Fetch survey results from the SurveyMonkey API and turn them into tidy data.frames in an optimized way.">
<meta property="og:description" content="Provides access to the SurveyMonkey API for fetching survey results. Fork of Sam Firke / Matt Roumaya's SurveyMonkey package, optimized for internal usage within SurveyMonkey.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">svmkR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="svmkr--">
<code>svmkR</code> <span class="emoji" data-emoji="clipboard">üìã</span> <span class="emoji" data-emoji="monkey">üêí</span>
<a class="anchor" aria-label="anchor" href="#svmkr--"></a>
</h1></div>
<!-- badges: start -->
<p>This package provides access from R to the SurveyMonkey API. <strong>It is a fork of <a href="https://github.com/mattroumaya/surveymonkey" class="external-link">Sam Firke / Matt Roumaya‚Äôs SurveyMonkey R package</a>, optimized for internal usage within SurveyMonkey.</strong> You can browse your surveys, pick one to fetch, and then, most importantly, parse the fetched JSON result into a tidy data.frame.</p>
<div class="section level3">
<h3 id="why-this-is-useful">Why this is useful<a class="anchor" aria-label="anchor" href="#why-this-is-useful"></a>
</h3>
<p>Compared to downloading .csv files manually:</p>
<ul>
<li>No fussing with the web browser or logging in</li>
<li>Column names are handled appropriately - not split over two rows</li>
<li>The columns are factors when appropriate, with the levels ordered based on the sequence the answers appear in the survey.<ul><li>And they have knowledge of all choices that were offered on the survey, even if they‚Äôre missing from the data because no one selected them. These values would be absent from a .csv download.</li></ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="project-status">Project status<a class="anchor" aria-label="anchor" href="#project-status"></a>
</h3>
<p><strong>What‚Äôs working:</strong></p>
<ul>
<li>All responses are pulled.</li>
<li>All metadata like custom variables and response start/end timestamps.</li>
<li>All substantive question types should be currently implemented.</li>
<li>Collector and recipient information can be retrieved.</li>
</ul>
<p>This is confirmed to work for paid plans at the Advantage and Premier levels. As of March 2022, it appears that standard &amp; basic (free) plans are granted API access with some limitations. Please feel free to open an issue or submit a PR to update documentation if permissions change, or if you have specific insight about API access based on type of account.</p>
<p><strong>What‚Äôs missing:</strong></p>
<p>Some uncommon question types may not yet be accounted for. E.g., image or upload question types are untested.</p>
<p>If you have a use case for something that isn‚Äôt currently pulled through, please open an issue describing your situation &amp; question type.</p>
</div>
<div class="section level3">
<h3 id="authors">Authors<a class="anchor" aria-label="anchor" href="#authors"></a>
</h3>
<p>The <a href="https://github.com/cloudyr/Rmonkey" class="external-link">first version of this package</a> was written by Thomas Leeper. It worked with version 2 of the SurveyMonkey API.</p>
<p>After SurveyMonkey‚Äôs change to v3 of their API broke the package, it was rewritten by employees of <a href="https://tntp.org" class="external-link">TNTP</a>, a nonprofit company working to end the injustice of educational inequality.</p>
<p>Matt Roumaya took over from TNTP as the de facto maintainer in 2021 and, in 2022, became the official maintainer of the package, keeping it going into another stage of its life.</p>
<p><strong>This version was forked from the TNTP version in July 2022 by Soubhik Barari while at Momentive.ai (maker of SurveyMonkey) and optimized for internal usage (e.g., faster reads, more verbose outputs, handling of API errors and edge cases, etc.).</strong></p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>This package is not yet on CRAN. Install from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"tgravelle/svmkR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h3>
<p><em>Have an opinion about OAuth procedures? If you can improve this guidance, please open an issue with your suggestions.</em></p>
<div class="section level4">
<h4 id="get-your-oauth-token">Get your OAuth token<a class="anchor" aria-label="anchor" href="#get-your-oauth-token"></a>
</h4>
<p>You‚Äôll need an OAuth token, and for that you‚Äôll need to set up an app.</p>
<p>Log in to SurveyMonkey in your browser, then navigate to <a href="https://developer.surveymonkey.com/apps" class="external-link uri">https://developer.surveymonkey.com/apps</a>. Create an app. It should be private, and you should enable the relevant scopes: View Surveys, View Collectors, View Contacts, View Responses, View Response Details. (That should do it, but if you get a 403 error when you try to browse surveys, try enabling other relevant scopes). You don‚Äôt need to click ‚Äúdeploy‚Äù, as long as the setting selected have been updated you‚Äôre set.</p>
<p>Now look at the settings page for your app and take note of the ‚ÄúAccess Token‚Äù field, which should contain a very long character string.</p>
</div>
<div class="section level4">
<h4 id="add-your-oauth-token-to-your-rprofile">Add your OAuth token to your .Rprofile<a class="anchor" aria-label="anchor" href="#add-your-oauth-token-to-your-rprofile"></a>
</h4>
<p>Add the SurveyMonkey account‚Äôs OAuth token to your .Rprofile file. To open and edit that file, run <code>usethis::edit_r_profile()</code>, then add a line like this: <code>options(sm_oauth_token = "kmda332fkdlakfld8am7ml3dafka-dafknalkfmalkfad-THIS IS NOT THE REAL KEY THOUGH")</code>.</p>
<p>Except use the OAuth token listed on your app‚Äôs settings page, obtained in the previous step.</p>
<p>Restart R for this change to take effect.</p>
<p>If this is all set up successfully, the token will print when you run <code>getOption("sm_oauth_token")</code>. Guard this token: don‚Äôt share it and don‚Äôt commit it in any repository.</p>
<p><em>Developer‚Äôs note: That‚Äôs how a user can get a single account‚Äôs OAuth token. It might be preferable if users could authenticate from within R. If someone has guidance for how users should obtain their OAuth token more generally, please submit a pull request or comment in an issue.</em></p>
</div>
</div>
<div class="section level3">
<h3 id="browsing-your-surveys">Browsing your surveys<a class="anchor" aria-label="anchor" href="#browsing-your-surveys"></a>
</h3>
<p>You‚Äôll need the ID number of the survey you wish to fetch. Find it by browsing your surveys like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surveys</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/browse_surveys.html">browse_surveys</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span> <span class="co"># see your most recent 200 surveys</span></span></code></pre></div>
<p>Then run <code>View(surveys)</code> and start typing the name of the survey you want into the search window at the top right of the RStudio data.frame viewer. That will get you the survey‚Äôs ID number. Copy it.</p>
</div>
<div class="section level3">
<h3 id="fetching-a-survey">Fetching a survey<a class="anchor" aria-label="anchor" href="#fetching-a-survey"></a>
</h3>
<p>Get the survey data like this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a_survey_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fetch_survey_obj.html">fetch_survey_obj</a></span><span class="op">(</span><span class="fl">123456789</span><span class="op">)</span> <span class="co"># your survey's ID goes here</span></span></code></pre></div>
<p>This returns a list of data about the survey. It‚Äôs useful for developers to explore, but not so much for most users. Keep going to the next step.</p>
</div>
<div class="section level3">
<h3 id="parsing-the-survey-into-a-dataframe">Parsing the survey into a data.frame<a class="anchor" aria-label="anchor" href="#parsing-the-survey-into-a-dataframe"></a>
</h3>
<p>This is the actual good part.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/parse_survey.html">parse_survey</a></span><span class="op">(</span><span class="va">a_survey_obj</span><span class="op">)</span></span></code></pre></div>
<p>That will give you a tidy data.frame with all of your responses.</p>
<p>In the future you can run it all as one command:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey_df</span> <span class="op">&lt;-</span> <span class="fl">123456789</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="va">fetch_survey_obj</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="va">parse_survey</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="retrieving-recipient-and-collector-data">Retrieving recipient and collector data<a class="anchor" aria-label="anchor" href="#retrieving-recipient-and-collector-data"></a>
</h3>
<p>This is handy for tracking who has completed a survey and managing reminder messages. Or retrieving a recipient‚Äôs unique survey link, if you‚Äôre sending invitation through an email collector.</p>
<p>Get a survey‚Äôs collector information, including collector IDs:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">collectors</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_collectors.html">get_collectors</a></span><span class="op">(</span><span class="fl">123456789</span><span class="op">)</span></span></code></pre></div>
<p>Then fetch a collector‚Äôs recipient info:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recipients</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_recipients.html">get_recipients</a></span><span class="op">(</span><span class="fl">234567890</span><span class="op">)</span> <span class="co"># use a collector ID retrieved in the previous step</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="removing-html-tags-from-column-names">Removing HTML tags from column names<a class="anchor" aria-label="anchor" href="#removing-html-tags-from-column-names"></a>
</h3>
<p>If your question text has bold font or other formatting, an HTML tag will likely carry through. You can remove any text between ‚Äú&lt;‚Äù and ‚Äú&gt;‚Äù with <code><a href="reference/strip_html.html">strip_html()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey_df</span> <span class="op">&lt;-</span> <span class="fl">123456789</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="va">fetch_survey_obj</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="va">parse_survey</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="va">strip_html</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="api-considerations">API considerations<a class="anchor" aria-label="anchor" href="#api-considerations"></a>
</h2>
<p>Your account will likely be limited to 500 hits per day to the API. This package will print reminders of how many calls you have left in the day. The main thing to keep an eye on is respondent counts; as only 100 responses can be fetched per API call, a survey with X respondents will make at least X/100 calls to the API.</p>
</div>
</div>
<div class="section level1">
<h1 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h1>
<p>Something may not work, because this is an in-development package. Or you may have an idea for something that hasn‚Äôt been implemented yet. In either case, please create an issue in the GitHub issue tracker!</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing svmkR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Matt Roumaya <br><small class="roles"> Author, maintainer </small>  </li>
<li>Sam Firke <br><small class="roles"> Author </small>  </li>
<li>Thomas J. Leeper <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-4097-6326" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://codecov.io/github/tntp/surveymonkey?branch=master" class="external-link"><img src="https://codecov.io/github/tntp/surveymonkey/coverage.svg?branch=master" alt="codecov.io"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="lifecycle"></a></li>
<li><a href="https://github.com/tntp/surveymonkey" class="external-link"><img src="https://github.com/tntp/surveymonkey/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Matt Roumaya, Sam Firke, Thomas J. Leeper.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
